<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Train-Test Split Visualizer</title>
    <link href="https://fonts.googleapis.com/css2?family=Geist:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --color-neutral-50: #fafafa;
            --color-neutral-100: #f5f5f5;
            --color-neutral-200: #e5e5e5;
            --color-neutral-300: #d4d4d4;
            --color-neutral-400: #a3a3a3;
            --color-neutral-500: #737373;
            --color-neutral-600: #525252;
            --color-neutral-700: #404040;
            --color-neutral-800: #262626;
            --color-neutral-900: #171717;

            --color-train: #5a9ea1;
            --color-train-light: #bfe5e7;
            --color-test: #6b9085;
            --color-test-light: #d1e7dd;
            --color-approved: #22c55e;
            --color-rejected: #a3a3a3;
            --color-success: #22c55e;
            --color-success-light: #dcfce7;
            --color-accent: #bfe5e7;
            --color-accent-dark: #5a9ea1;
            --color-correct: #c0d1cd;
            --color-correct-bg: #f0f5f4;
            --color-incorrect: #f0ede0;
            --color-incorrect-bg: #faf9f5;
        }

        body {
            font-family: 'Geist', -apple-system, sans-serif;
            background: white;
            color: var(--color-neutral-900);
            padding: 1.5rem;
            line-height: 1.6;
        }

        .visualizer-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .header h3 {
            color: var(--color-neutral-900);
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: var(--color-neutral-600);
            font-size: 0.875rem;
        }

        /* Slider control */
        .slider-section {
            background: var(--color-neutral-50);
            border: 1px solid var(--color-neutral-200);
            border-radius: 12px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .slider-label {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--color-neutral-800);
        }

        .split-display {
            display: flex;
            gap: 1rem;
            font-size: 0.85rem;
        }

        .split-value {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-weight: 600;
        }

        .split-value.train {
            background: var(--color-train-light);
            color: var(--color-train);
        }

        .split-value.test {
            background: var(--color-test-light);
            color: var(--color-test);
        }

        .slider-wrapper {
            position: relative;
            padding: 0.5rem 0;
        }

        .split-slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(to right, var(--color-train) 0%, var(--color-train) var(--train-percent), var(--color-test) var(--train-percent), var(--color-test) 100%);
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
        }

        .split-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            border: 3px solid var(--color-neutral-700);
            cursor: grab;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .split-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            border: 3px solid var(--color-neutral-700);
            cursor: grab;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .split-slider:focus {
            outline: none;
        }

        .split-slider:focus::-webkit-slider-thumb {
            border-color: #3182ce;
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.3);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: var(--color-neutral-500);
            margin-top: 0.5rem;
        }

        /* Visualization grid */
        .viz-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .data-panel {
            background: var(--color-neutral-50);
            border: 1px solid var(--color-neutral-200);
            border-radius: 12px;
            padding: 1rem;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .panel-title {
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .panel-title.train { color: var(--color-train); }
        .panel-title.test { color: var(--color-test); }

        .panel-count {
            font-size: 0.8rem;
            color: var(--color-neutral-500);
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(20, 1fr);
            gap: 2px;
            height: 120px;
            overflow: hidden;
        }

        .data-block {
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .data-block.approved {
            background: var(--color-accent-dark);
        }

        .data-block.rejected {
            background: var(--color-neutral-300);
        }

        /* Stats panel */
        .stats-panel {
            background: white;
            border: 1px solid var(--color-neutral-200);
            border-radius: 8px;
            padding: 0.75rem;
            margin-top: 0.75rem;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 0.375rem 0;
            font-size: 0.8rem;
        }

        .stat-label {
            color: var(--color-neutral-600);
        }

        .stat-value {
            font-weight: 600;
            color: var(--color-neutral-800);
        }

        .stat-value.match {
            color: var(--color-accent-dark);
        }

        /* Explanation box */
        .explanation-box {
            background: #f5fafa;
            border-left: 3px solid var(--color-accent);
            border-radius: 0 8px 8px 0;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .explanation-box h4 {
            font-size: 0.9rem;
            color: var(--color-neutral-900);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .explanation-box p {
            font-size: 0.85rem;
            color: var(--color-neutral-700);
        }

        /* Quiz section */
        .quiz-section {
            background: var(--color-neutral-50);
            border: 1px solid var(--color-neutral-200);
            border-radius: 12px;
            padding: 1.25rem;
        }

        .quiz-header {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 1rem;
            color: var(--color-neutral-800);
        }

        .quiz-question {
            margin-bottom: 1.25rem;
            padding-bottom: 1.25rem;
            border-bottom: 1px solid var(--color-neutral-200);
        }

        .quiz-question:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .quiz-question h4 {
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.625rem;
            color: var(--color-neutral-800);
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.375rem;
        }

        .quiz-option {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            padding: 0.625rem;
            background: white;
            border: 1px solid var(--color-neutral-200);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quiz-option:hover {
            border-color: var(--color-neutral-400);
            background: var(--color-neutral-50);
        }

        .quiz-option:focus-within {
            outline: 2px solid #3182ce;
            outline-offset: 2px;
        }

        .quiz-option.selected {
            border-color: var(--color-neutral-900);
            background: var(--color-neutral-50);
        }

        .quiz-option.correct {
            border-color: var(--color-correct);
            background: var(--color-correct-bg);
        }

        .quiz-option.incorrect {
            border-color: var(--color-incorrect);
            background: var(--color-incorrect-bg);
        }

        .quiz-option input { margin-top: 2px; }

        .quiz-option label {
            font-size: 0.825rem;
            color: var(--color-neutral-700);
            cursor: pointer;
            flex: 1;
        }

        .quiz-feedback {
            padding: 0.625rem;
            border-radius: 6px;
            font-size: 0.825rem;
            margin-top: 0.5rem;
            display: none;
        }

        .quiz-feedback.correct {
            background: var(--color-correct-bg);
            color: var(--color-neutral-900);
            display: block;
        }

        .quiz-feedback.incorrect {
            background: var(--color-incorrect-bg);
            color: var(--color-neutral-900);
            display: block;
        }

        .check-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.625rem 1.25rem;
            background: var(--color-neutral-900);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 1rem;
        }

        .check-btn:hover {
            background: var(--color-neutral-700);
        }

        .check-btn:focus {
            outline: 2px solid #3182ce;
            outline-offset: 2px;
        }

        /* Legend */
        .legend {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            margin-bottom: 1rem;
            font-size: 0.8rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.375rem;
            color: var(--color-neutral-600);
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }

        .legend-dot.approved { background: var(--color-accent-dark); }
        .legend-dot.rejected { background: var(--color-neutral-300); }

        /* Screen reader only */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Responsive */
        @media (max-width: 700px) {
            body { padding: 1rem; }
            .viz-section { grid-template-columns: 1fr; }
            .data-grid { grid-template-columns: repeat(15, 1fr); height: 80px; }
        }
    </style>
</head>
<body>
    <div class="visualizer-container">
        <div class="header">
            <h3>Train-Test Split Visualizer</h3>
            <p>Understand why we split data into training and testing sets</p>
        </div>

        <!-- Slider control -->
        <div class="slider-section">
            <div class="slider-header">
                <span class="slider-label">Adjust Split Ratio</span>
                <div class="split-display">
                    <span class="split-value train">Train: <span id="trainPercent">80</span>%</span>
                    <span class="split-value test">Test: <span id="testPercent">20</span>%</span>
                </div>
            </div>
            <div class="slider-wrapper">
                <input type="range" class="split-slider" id="splitSlider" min="50" max="90" value="80"
                       aria-label="Train-test split ratio" style="--train-percent: 80%">
            </div>
            <div class="slider-labels">
                <span>50% Train</span>
                <span>80% (Standard)</span>
                <span>90% Train</span>
            </div>
        </div>

        <!-- Legend -->
        <div class="legend">
            <div class="legend-item">
                <span class="legend-dot approved"></span>
                <span>Loan Approved (~22%)</span>
            </div>
            <div class="legend-item">
                <span class="legend-dot rejected"></span>
                <span>Loan Rejected (~78%)</span>
            </div>
        </div>

        <!-- Visualization -->
        <div class="viz-section">
            <div class="data-panel">
                <div class="panel-header">
                    <span class="panel-title train">Training Set</span>
                    <span class="panel-count" id="trainCount">36,000 rows</span>
                </div>
                <div class="data-grid" id="trainGrid"></div>
                <div class="stats-panel">
                    <div class="stat-row">
                        <span class="stat-label">Total Records</span>
                        <span class="stat-value" id="trainTotal">36,000</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Approval Rate</span>
                        <span class="stat-value match" id="trainApproval">22.1%</span>
                    </div>
                </div>
            </div>

            <div class="data-panel">
                <div class="panel-header">
                    <span class="panel-title test">Testing Set</span>
                    <span class="panel-count" id="testCount">9,000 rows</span>
                </div>
                <div class="data-grid" id="testGrid"></div>
                <div class="stats-panel">
                    <div class="stat-row">
                        <span class="stat-label">Total Records</span>
                        <span class="stat-value" id="testTotal">9,000</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Approval Rate</span>
                        <span class="stat-value match" id="testApproval">21.9%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Explanation -->
        <div class="explanation-box">
            <h4>
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M12 16v-4M12 8h.01"></path>
                </svg>
                Why Proportions Match
            </h4>
            <p>Notice that both sets maintain the same ~22% approval rate. This is called <strong>stratified sampling</strong>—it ensures the test set is representative of the full dataset. If we accidentally put more approved loans in training, our test results wouldn't reflect real-world performance.</p>
        </div>

        <!-- Quiz -->
        <div class="quiz-section">
            <h4 class="quiz-header">Test Your Understanding</h4>

            <div class="quiz-question" data-correct="b">
                <h4>1. Why do we need a separate test set?</h4>
                <div class="quiz-options">
                    <div class="quiz-option" onclick="selectOption(this, 'q1')">
                        <input type="radio" name="q1" value="a" id="q1a">
                        <label for="q1a">To make the model train faster</label>
                    </div>
                    <div class="quiz-option" onclick="selectOption(this, 'q1')">
                        <input type="radio" name="q1" value="b" id="q1b">
                        <label for="q1b">To measure how well the model predicts unseen data</label>
                    </div>
                    <div class="quiz-option" onclick="selectOption(this, 'q1')">
                        <input type="radio" name="q1" value="c" id="q1c">
                        <label for="q1c">Because we don't have enough storage for all data</label>
                    </div>
                </div>
                <div class="quiz-feedback" id="feedback-q1"></div>
            </div>

            <div class="quiz-question" data-correct="a">
                <h4>2. What happens if you test on the same data you trained on?</h4>
                <div class="quiz-options">
                    <div class="quiz-option" onclick="selectOption(this, 'q2')">
                        <input type="radio" name="q2" value="a" id="q2a">
                        <label for="q2a">The model appears more accurate than it really is (overfitting)</label>
                    </div>
                    <div class="quiz-option" onclick="selectOption(this, 'q2')">
                        <input type="radio" name="q2" value="b" id="q2b">
                        <label for="q2b">The model becomes more accurate at predictions</label>
                    </div>
                    <div class="quiz-option" onclick="selectOption(this, 'q2')">
                        <input type="radio" name="q2" value="c" id="q2c">
                        <label for="q2c">Nothing—the results are exactly the same</label>
                    </div>
                </div>
                <div class="quiz-feedback" id="feedback-q2"></div>
            </div>

            <div class="quiz-question" data-correct="c">
                <h4>3. Why is 80/20 a common split ratio?</h4>
                <div class="quiz-options">
                    <div class="quiz-option" onclick="selectOption(this, 'q3')">
                        <input type="radio" name="q3" value="a" id="q3a">
                        <label for="q3a">It's required by machine learning libraries</label>
                    </div>
                    <div class="quiz-option" onclick="selectOption(this, 'q3')">
                        <input type="radio" name="q3" value="b" id="q3b">
                        <label for="q3b">It gives the model exactly 80% accuracy</label>
                    </div>
                    <div class="quiz-option" onclick="selectOption(this, 'q3')">
                        <input type="radio" name="q3" value="c" id="q3c">
                        <label for="q3c">It balances having enough training data with enough test data for reliable evaluation</label>
                    </div>
                </div>
                <div class="quiz-feedback" id="feedback-q3"></div>
            </div>

            <button class="check-btn" onclick="checkAnswers()">Check Answers</button>
        </div>
    </div>

    <div role="status" aria-live="polite" class="sr-only" id="announcements"></div>

    <script>
        const TOTAL_DATA = 45000;
        const APPROVAL_RATE = 0.22;
        const DISPLAY_BLOCKS = 200; // Number of visual blocks to show

        const slider = document.getElementById('splitSlider');

        // Initialize grids
        function generateBlocks(count, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            const displayCount = Math.round((count / TOTAL_DATA) * DISPLAY_BLOCKS);
            const approvedCount = Math.round(displayCount * APPROVAL_RATE);

            // Create shuffled array
            const blocks = [];
            for (let i = 0; i < displayCount; i++) {
                blocks.push(i < approvedCount ? 'approved' : 'rejected');
            }
            // Shuffle
            for (let i = blocks.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [blocks[i], blocks[j]] = [blocks[j], blocks[i]];
            }

            blocks.forEach(type => {
                const block = document.createElement('div');
                block.className = `data-block ${type}`;
                container.appendChild(block);
            });
        }

        function updateVisualization() {
            const trainPercent = parseInt(slider.value);
            const testPercent = 100 - trainPercent;

            // Update displays
            document.getElementById('trainPercent').textContent = trainPercent;
            document.getElementById('testPercent').textContent = testPercent;

            // Update slider gradient
            slider.style.setProperty('--train-percent', trainPercent + '%');

            // Calculate counts
            const trainCount = Math.round(TOTAL_DATA * trainPercent / 100);
            const testCount = TOTAL_DATA - trainCount;

            // Update counts
            document.getElementById('trainCount').textContent = trainCount.toLocaleString() + ' rows';
            document.getElementById('testCount').textContent = testCount.toLocaleString() + ' rows';
            document.getElementById('trainTotal').textContent = trainCount.toLocaleString();
            document.getElementById('testTotal').textContent = testCount.toLocaleString();

            // Simulate slight variation in approval rates (realistic stratified sampling)
            const trainApproval = (APPROVAL_RATE + (Math.random() - 0.5) * 0.01) * 100;
            const testApproval = (APPROVAL_RATE + (Math.random() - 0.5) * 0.01) * 100;

            document.getElementById('trainApproval').textContent = trainApproval.toFixed(1) + '%';
            document.getElementById('testApproval').textContent = testApproval.toFixed(1) + '%';

            // Regenerate blocks
            generateBlocks(trainCount, 'trainGrid');
            generateBlocks(testCount, 'testGrid');

            announce(`Split updated: ${trainPercent}% training (${trainCount.toLocaleString()} rows), ${testPercent}% testing (${testCount.toLocaleString()} rows)`);
        }

        slider.addEventListener('input', updateVisualization);

        // Quiz functions
        function selectOption(element, questionName) {
            const options = element.parentElement.querySelectorAll('.quiz-option');
            options.forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            element.querySelector('input').checked = true;
        }

        const explanations = {
            q1: {
                correct: "Correct! The test set measures generalization—whether the model can predict data it has never seen before. This reveals its true predictive power.",
                incorrect: "Not quite. The test set exists to evaluate how well the model predicts unseen data. A model that only knows training data might just memorize patterns instead of learning them."
            },
            q2: {
                correct: "Correct! This is called overfitting. The model 'memorizes' training data and appears highly accurate, but fails on new data. It's like memorizing answers to a practice test—you'll ace that test but struggle on the real exam.",
                incorrect: "Actually, testing on training data leads to overfitting. The model appears more accurate because it has already 'seen' the answers, but it doesn't measure real predictive ability."
            },
            q3: {
                correct: "Correct! 80/20 is a practical balance: 80% provides enough data for the model to learn patterns, while 20% gives enough test cases for statistically reliable evaluation. Different domains may adjust this ratio.",
                incorrect: "The 80/20 split isn't required or related to accuracy targets—it's simply a practical balance between having enough training data to learn and enough test data to evaluate reliably."
            }
        };

        function checkAnswers() {
            const questions = document.querySelectorAll('.quiz-question');
            let allCorrect = true;

            questions.forEach((q, index) => {
                const correct = q.dataset.correct;
                const selected = q.querySelector('input:checked');
                const feedback = document.getElementById(`feedback-q${index + 1}`);
                const options = q.querySelectorAll('.quiz-option');
                const qKey = `q${index + 1}`;

                options.forEach(opt => {
                    opt.classList.remove('correct', 'incorrect');
                    const input = opt.querySelector('input');
                    if (input.value === correct) {
                        opt.classList.add('correct');
                    }
                });

                if (selected) {
                    const selectedOption = selected.closest('.quiz-option');
                    if (selected.value === correct) {
                        feedback.textContent = explanations[qKey].correct;
                        feedback.className = 'quiz-feedback correct';
                    } else {
                        selectedOption.classList.add('incorrect');
                        feedback.textContent = explanations[qKey].incorrect;
                        feedback.className = 'quiz-feedback incorrect';
                        allCorrect = false;
                    }
                } else {
                    feedback.textContent = 'Please select an answer.';
                    feedback.className = 'quiz-feedback incorrect';
                    allCorrect = false;
                }
            });

            announce(allCorrect ? 'All answers correct!' : 'Some answers incorrect. Review the feedback.');
        }

        function announce(message) {
            const announcer = document.getElementById('announcements');
            announcer.textContent = message;
            setTimeout(() => { announcer.textContent = ''; }, 1000);
        }

        // Initialize
        updateVisualization();
    </script>
</body>
</html>
