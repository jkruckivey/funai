<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML Validation Strategy Simulator</title>
    <style>
        body {
            font-family: 'GeistSans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #034638 0%, #582C83 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1300px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        h1 {
            font-family: 'GeistSans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: #034638;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.2em;
            font-weight: bold;
        }
        
        .podcast-highlight {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border-left: 4px solid #034638;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            font-style: italic;
        }
        
        .validation-stages {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }
        
        .validation-stage {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 3px solid #e5e7eb;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        
        .validation-stage:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
        }
        
        .validation-stage.active {
            border-color: #034638;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }
        
        .validation-stage.completed {
            border-color: #16a34a;
            background: linear-gradient(135deg, #f0fdf4 0%, #bbf7d0 100%);
        }
        
        .validation-stage.failed {
            border-color: #dc2626;
            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
        }
        
        .stage-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            font-size: 1.3em;
            font-weight: bold;
            color: #034638;
        }
        
        .stage-icon {
            font-size: 2em;
            margin-right: 10px;
        }
        
        .stage-description {
            color: #63666A;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .performance-indicator {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .performance-value {
            font-size: 2em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .good { color: #16a34a; }
        .warning { color: #d97706; }
        .danger { color: #dc2626; }
        
        .controls-panel {
            background: #f9fafb;
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #e5e7eb;
        }
        
        .scenario-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .scenario-btn {
            background: linear-gradient(135deg, #582C83 0%, #034638 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .scenario-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .scenario-btn.active {
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
        }
        
        .data-quality-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .control-group {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .control-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #034638;
        }
        
        .slider-container {
            margin: 10px 0;
        }
        
        input[type="range"] {
            width: 100%;
            margin: 8px 0;
        }
        
        .slider-value {
            text-align: center;
            font-weight: bold;
            color: #63666A;
        }
        
        .validation-button {
            background: linear-gradient(135deg, #034638 0%, #582C83 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1em;
            margin: 10px;
            transition: all 0.3s ease;
        }
        
        .validation-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        
        .validation-button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .results-panel {
            background: #f3f4f6;
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #d1d5db;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .comparison-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .insight-box {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border: 2px solid #034638;
            border-radius: 12px;
            padding: 20px;
            margin: 25px 0;
        }
        
        .insight-box h3 {
            color: #034638;
            font-family: 'GeistSans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #d97706;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            display: none;
        }
        
        .warning-box.show {
            display: block;
        }
        
        .progress-bar {
            background: #e5e7eb;
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.8em;
        }
        
        .reset-btn {
            background: #63666A;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px;
        }
        
        .step-counter {
            background: #034638;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: absolute;
            top: -10px;
            right: -10px;
        }
        
        .subtitle {
            text-align: center;
            color: #63666A;
            font-size: 1.1em;
            margin-bottom: 20px;
        }

        h3 {
            font-family: 'GeistSans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: #034638;
            font-size: 1.4em;
            margin-bottom: 15px;
        }

        h4 {
            font-family: 'GeistSans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: #034638;
            margin-bottom: 10px;
        }
        
        .reflection-box {
            background: linear-gradient(135deg, #e7f4ea 0%, #d1f2d9 100%);
            border: 2px solid #16a34a;
            border-radius: 12px;
            padding: 20px;
            margin: 25px 0;
        }
        
        .reflection-box h3 {
            color: #16a34a;
            font-family: 'GeistSans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧪 ML Validation Strategy Simulator</h1>
        <p class="subtitle">
            Experience why external validation is "shockingly rare" but critical for trustworthy AI
        </p>

        <div class="podcast-highlight">
            <strong>Professor Lauren Cyprian:</strong> "External validation is shockingly rare, but it's really a best practice. You collect a new, fully independent data set and test the model using that independent data set. This is the truest test of asking: is my model generalizable to other settings? You actually have to test it in those other settings."
        </div>

        <div class="scenario-selector">
            <button class="scenario-btn active" onclick="setScenario('compas')" id="compas-btn">⚖️ COMPAS Algorithm</button>
            <button class="scenario-btn" onclick="setScenario('hiring')" id="hiring-btn">💼 Hiring AI</button>
            <button class="scenario-btn" onclick="setScenario('medical')" id="medical-btn">🏥 Medical Diagnosis</button>
            <button class="scenario-btn" onclick="setScenario('fraud')" id="fraud-btn">🛡️ Fraud Detection</button>
        </div>

        <div class="validation-stages">
            <div class="validation-stage" id="internal-validation" onclick="selectStage('internal')">
                <div class="step-counter">1</div>
                <div class="stage-header">
                    <span class="stage-icon">📊</span>
                    Internal Validation
                </div>
                <div class="stage-description">
                    Split your data 70/30. Train on one part, test on the other.
                </div>
                <div class="performance-indicator">
                    <div class="performance-value" id="internal-accuracy">--</div>
                    <div>Accuracy</div>
                </div>
                <button class="validation-button" onclick="runInternalValidation()" id="internal-btn" disabled>
                    Run Internal Test
                </button>
            </div>

            <div class="validation-stage" id="cross-validation" onclick="selectStage('cross')">
                <div class="step-counter">2</div>
                <div class="stage-header">
                    <span class="stage-icon">🔄</span>
                    Cross-Validation
                </div>
                <div class="stage-description">
                    Create hundreds of train/test splits for robust estimates.
                </div>
                <div class="performance-indicator">
                    <div class="performance-value" id="cross-accuracy">--</div>
                    <div>Average Accuracy</div>
                </div>
                <button class="validation-button" onclick="runCrossValidation()" id="cross-btn" disabled>
                    Run Cross-Validation
                </button>
            </div>

            <div class="validation-stage" id="external-validation" onclick="selectStage('external')">
                <div class="step-counter">3</div>
                <div class="stage-header">
                    <span class="stage-icon">🌍</span>
                    External Validation
                </div>
                <div class="stage-description">
                    Test on completely independent data from different locations/times.
                </div>
                <div class="performance-indicator">
                    <div class="performance-value" id="external-accuracy">--</div>
                    <div>True Performance</div>
                </div>
                <button class="validation-button" onclick="runExternalValidation()" id="external-btn" disabled>
                    Run External Test
                </button>
            </div>
        </div>

        <div class="controls-panel">
            <h3>🎛️ Configure Your Data Quality</h3>
            <p>Adjust these settings to see how they affect validation results:</p>
            
            <div class="data-quality-controls">
                <div class="control-group">
                    <label for="dataSize">Training Data Size:</label>
                    <div class="slider-container">
                        <input type="range" id="dataSize" min="500" max="10000" value="2000" step="500" oninput="updateSimulation()">
                        <div class="slider-value"><span id="dataSizeValue">2000</span> records</div>
                    </div>
                </div>

                <div class="control-group">
                    <label for="dataQuality">Data Quality:</label>
                    <div class="slider-container">
                        <input type="range" id="dataQuality" min="20" max="100" value="80" oninput="updateSimulation()">
                        <div class="slider-value"><span id="dataQualityValue">80</span>% clean</div>
                    </div>
                </div>

                <div class="control-group">
                    <label for="populationShift">Population Shift:</label>
                    <div class="slider-container">
                        <input type="range" id="populationShift" min="0" max="50" value="15" oninput="updateSimulation()">
                        <div class="slider-value"><span id="populationShiftValue">15</span>% difference</div>
                    </div>
                </div>

                <div class="control-group">
                    <label for="temporalDrift">Temporal Drift:</label>
                    <div class="slider-container">
                        <input type="range" id="temporalDrift" min="0" max="30" value="10" oninput="updateSimulation()">
                        <div class="slider-value"><span id="temporalDriftValue">10</span>% change over time</div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="validation-button" onclick="startValidation()" id="start-btn">
                    🚀 Start Validation Process
                </button>
                <button class="reset-btn" onclick="resetSimulation()">
                    🔄 Reset Simulation
                </button>
            </div>
        </div>

        <div class="warning-box" id="warning-box">
            <h4>⚠️ Reality Check</h4>
            <p id="warning-text">Most companies stop at internal validation due to cost and complexity.</p>
        </div>

        <div class="results-panel" id="results-panel" style="display: none;">
            <h3>📈 Validation Results Comparison</h3>
            <div class="comparison-grid" id="results-grid"></div>
            
            <div style="margin-top: 25px;">
                <h4>Performance Degradation</h4>
                <div class="progress-bar">
                    <div class="progress-fill" id="degradation-bar" style="width: 0%; background: linear-gradient(135deg, #16a34a 0%, #dc2626 100%);">
                        <span id="degradation-text">0%</span>
                    </div>
                </div>
                <p style="text-align: center; color: #63666A; margin-top: 10px;">
                    Performance drop from internal to external validation
                </p>
            </div>
        </div>

        <div class="insight-box">
            <h3>💡 Current Insight</h3>
            <p id="current-insight">Configure your data settings above and start the validation process to see why external validation reveals the truth about model performance.</p>
        </div>


        <div class="reflection-box">
            <h3>🤔 Reflection Questions</h3>
            <ol>
                <li>Why do you think external validation is "shockingly rare" in practice?</li>
                <li>What would it cost your organization to collect independent validation data?</li>
                <li>How would you convince leadership to invest in external validation?</li>
                <li>What questions should you ask AI vendors about their validation approach?</li>
                <li>When might the cost of external validation be worth it vs. not worth it?</li>
            </ol>
        </div>
    </div>

    <script>
        let currentScenario = 'compas';
        let validationStage = 0;
        let validationResults = {};

        const scenarios = {
            compas: {
                name: "COMPAS Recidivism Prediction",
                baseAccuracy: 68,
                description: "Predicting recidivism across different jurisdictions",
                realWorldExample: "COMPAS was developed in Florida but used nationwide without proper external validation.",
                challenges: [
                    "Different policing practices across jurisdictions",
                    "Varying crime rates and demographics",
                    "Changes in criminal justice policies over time",
                    "Different court procedures and data collection methods"
                ]
            },
            hiring: {
                name: "AI Hiring Algorithm",
                baseAccuracy: 75,
                description: "Screening job candidates for technical roles",
                realWorldExample: "Amazon scrapped their hiring AI when it showed bias against women.",
                challenges: [
                    "Different job markets and skill demands",
                    "Varying company cultures and values",
                    "Changes in technology and skill requirements",
                    "Different resume formats and screening processes"
                ]
            },
            medical: {
                name: "Medical Diagnosis AI",
                baseAccuracy: 82,
                description: "Diagnosing skin cancer from images",
                realWorldExample: "Many medical AI systems trained on one population fail on others.",
                challenges: [
                    "Different patient populations and genetics",
                    "Varying medical equipment and image quality",
                    "Different prevalence rates across regions",
                    "Changes in medical protocols and standards"
                ]
            },
            fraud: {
                name: "Fraud Detection System",
                baseAccuracy: 79,
                description: "Detecting credit card fraud",
                realWorldExample: "Fraud patterns change rapidly, making historical data less reliable.",
                challenges: [
                    "Evolving fraud techniques and technologies",
                    "Different spending patterns across regions",
                    "Seasonal variations in transaction patterns",
                    "Changes in payment methods and technologies"
                ]
            }
        };

        function setScenario(scenarioName) {
            // Update button states
            document.querySelectorAll('.scenario-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(scenarioName + '-btn').classList.add('active');
            
            currentScenario = scenarioName;
            const scenario = scenarios[scenarioName];
            
            // Reset simulation
            resetSimulation();
            
            // Update insight with scenario context
            updateInsight(`Selected: ${scenario.name}. ${scenario.description}. Real-world challenge: ${scenario.realWorldExample}`);
        }

        function updateSimulation() {
            const dataSize = parseInt(document.getElementById('dataSize').value);
            const dataQuality = parseInt(document.getElementById('dataQuality').value);
            const populationShift = parseInt(document.getElementById('populationShift').value);
            const temporalDrift = parseInt(document.getElementById('temporalDrift').value);
            
            // Update display values
            document.getElementById('dataSizeValue').textContent = dataSize.toLocaleString();
            document.getElementById('dataQualityValue').textContent = dataQuality;
            document.getElementById('populationShiftValue').textContent = populationShift;
            document.getElementById('temporalDriftValue').textContent = temporalDrift;
            
            // Show warnings based on settings
            showWarnings(dataSize, dataQuality, populationShift, temporalDrift);
        }

        function showWarnings(dataSize, dataQuality, populationShift, temporalDrift) {
            const warningBox = document.getElementById('warning-box');
            let warnings = [];
            
            if (dataSize < 2000) warnings.push("Small data size increases overfitting risk");
            if (dataQuality < 60) warnings.push("Low data quality will inflate internal validation accuracy");
            if (populationShift > 25) warnings.push("High population shift will cause major external validation drops");
            if (temporalDrift > 20) warnings.push("High temporal drift means your model will age quickly");
            
            if (warnings.length > 0) {
                document.getElementById('warning-text').innerHTML = warnings.join('. ') + '.';
                warningBox.classList.add('show');
            } else {
                warningBox.classList.remove('show');
            }
        }

        function startValidation() {
            validationStage = 0;
            validationResults = {};
            
            // Enable first stage
            document.getElementById('internal-btn').disabled = false;
            document.getElementById('start-btn').disabled = true;
            
            // Reset stage styling
            document.querySelectorAll('.validation-stage').forEach(stage => {
                stage.className = 'validation-stage';
            });
            document.getElementById('internal-validation').classList.add('active');
            
            updateInsight("Validation process started! Begin with internal validation to get your first performance estimate.");
        }

        function runInternalValidation() {
            const scenario = scenarios[currentScenario];
            const dataSize = parseInt(document.getElementById('dataSize').value);
            const dataQuality = parseInt(document.getElementById('dataQuality').value);
            
            // Calculate internal validation accuracy (usually optimistic)
            let accuracy = scenario.baseAccuracy;
            
            // Data size effect
            if (dataSize > 5000) accuracy += 3;
            else if (dataSize < 1500) accuracy -= 2;
            
            // Data quality effect (high quality = higher internal accuracy due to less noise)
            accuracy += Math.round((dataQuality - 50) / 10);
            
            // Add small random variation
            accuracy += Math.random() * 6 - 3;
            accuracy = Math.max(50, Math.min(95, Math.round(accuracy)));
            
            validationResults.internal = accuracy;
            document.getElementById('internal-accuracy').textContent = accuracy + '%';
            document.getElementById('internal-accuracy').className = 'performance-value ' + getPerformanceClass(accuracy);
            
            // Update stage styling
            document.getElementById('internal-validation').classList.remove('active');
            document.getElementById('internal-validation').classList.add('completed');
            document.getElementById('cross-validation').classList.add('active');
            
            // Enable next stage
            document.getElementById('internal-btn').disabled = true;
            document.getElementById('cross-btn').disabled = false;
            
            updateInsight(`Internal validation complete: ${accuracy}% accuracy. This is your baseline estimate, but it may be overly optimistic. Proceed to cross-validation for a more robust estimate.`);
        }

        function runCrossValidation() {
            const internalAccuracy = validationResults.internal;
            
            // Cross-validation usually shows slightly lower accuracy due to multiple splits
            let accuracy = internalAccuracy - (Math.random() * 4 + 1);
            accuracy = Math.max(40, Math.round(accuracy));
            
            validationResults.cross = accuracy;
            document.getElementById('cross-accuracy').textContent = accuracy + '%';
            document.getElementById('cross-accuracy').className = 'performance-value ' + getPerformanceClass(accuracy);
            
            // Update stage styling
            document.getElementById('cross-validation').classList.remove('active');
            document.getElementById('cross-validation').classList.add('completed');
            document.getElementById('external-validation').classList.add('active');
            
            // Enable next stage
            document.getElementById('cross-btn').disabled = true;
            document.getElementById('external-btn').disabled = false;
            
            const drop = internalAccuracy - accuracy;
            updateInsight(`Cross-validation complete: ${accuracy}% accuracy (${drop.toFixed(1)}% drop from internal). This is more reliable, but still uses your original data. External validation will reveal true performance.`);
        }

        function runExternalValidation() {
            const crossAccuracy = validationResults.cross;
            const populationShift = parseInt(document.getElementById('populationShift').value);
            const temporalDrift = parseInt(document.getElementById('temporalDrift').value);
            const dataQuality = parseInt(document.getElementById('dataQuality').value);
            
            // External validation shows reality - usually significant drop
            let accuracy = crossAccuracy;
            
            // Population shift effect
            accuracy -= populationShift * 0.8;
            
            // Temporal drift effect
            accuracy -= temporalDrift * 0.6;
            
            // Data quality effect (poor quality = bigger external drop)
            if (dataQuality < 70) {
                accuracy -= (70 - dataQuality) * 0.3;
            }
            
            // Add scenario-specific challenges
            const scenario = scenarios[currentScenario];
            if (currentScenario === 'medical') accuracy -= 5; // Medical AI often has bigger drops
            if (currentScenario === 'fraud') accuracy -= 8; // Fraud patterns change rapidly
            
            accuracy = Math.max(25, Math.round(accuracy));
            
            validationResults.external = accuracy;
            document.getElementById('external-accuracy').textContent = accuracy + '%';
            document.getElementById('external-accuracy').className = 'performance-value ' + getPerformanceClass(accuracy);
            
            // Update stage styling
            document.getElementById('external-validation').classList.remove('active');
            if (accuracy >= 60) {
                document.getElementById('external-validation').classList.add('completed');
            } else {
                document.getElementById('external-validation').classList.add('failed');
            }
            
            // Disable button and show results
            document.getElementById('external-btn').disabled = true;
            showResults();
            
            const totalDrop = validationResults.internal - accuracy;
            const verdict = accuracy >= 60 ? 'acceptable' : 'concerning';
            updateInsight(`External validation complete: ${accuracy}% accuracy (${totalDrop.toFixed(1)}% total drop). This ${verdict} performance represents what you'd see in the real world.`);
        }

        function showResults() {
            const resultsPanel = document.getElementById('results-panel');
            const resultsGrid = document.getElementById('results-grid');
            
            const internal = validationResults.internal;
            const cross = validationResults.cross;
            const external = validationResults.external;
            
            resultsGrid.innerHTML = `
                <div class="comparison-card">
                    <h4>Internal Validation</h4>
                    <div class="performance-value ${getPerformanceClass(internal)}">${internal}%</div>
                    <p>Quick and easy, but often overly optimistic</p>
                </div>
                <div class="comparison-card">
                    <h4>Cross-Validation</h4>
                    <div class="performance-value ${getPerformanceClass(cross)}">${cross}%</div>
                    <p>More robust, but still uses same data source</p>
                </div>
                <div class="comparison-card">
                    <h4>External Validation</h4>
                    <div class="performance-value ${getPerformanceClass(external)}">${external}%</div>
                    <p>True performance - what you'll see in production</p>
                </div>
            `;
            
            // Update degradation bar
            const totalDrop = internal - external;
            const degradationPercent = Math.min(100, Math.max(0, (totalDrop / internal) * 100));
            
            const degradationBar = document.getElementById('degradation-bar');
            degradationBar.style.width = degradationPercent + '%';
            document.getElementById('degradation-text').textContent = totalDrop.toFixed(1) + '%';
            
            // Set bar color based on degradation severity
            if (degradationPercent < 10) {
                degradationBar.style.background = '#16a34a'; // Green - good
            } else if (degradationPercent < 25) {
                degradationBar.style.background = '#d97706'; // Orange - concerning
            } else {
                degradationBar.style.background = '#dc2626'; // Red - problematic
            }
            
            resultsPanel.style.display = 'block';
        }

        function getPerformanceClass(accuracy) {
            if (accuracy >= 75) return 'good';
            if (accuracy >= 60) return 'warning';
            return 'danger';
        }

        function resetSimulation() {
            validationStage = 0;
            validationResults = {};
            
            // Reset all displays
            document.getElementById('internal-accuracy').textContent = '--';
            document.getElementById('cross-accuracy').textContent = '--';
            document.getElementById('external-accuracy').textContent = '--';
            
            document.getElementById('internal-accuracy').className = 'performance-value';
            document.getElementById('cross-accuracy').className = 'performance-value';
            document.getElementById('external-accuracy').className = 'performance-value';
            
            // Reset stages
            document.querySelectorAll('.validation-stage').forEach(stage => {
                stage.className = 'validation-stage';
            });
            
            // Reset buttons
            document.getElementById('start-btn').disabled = false;
            document.getElementById('internal-btn').disabled = true;
            document.getElementById('cross-btn').disabled = true;
            document.getElementById('external-btn').disabled = true;
            
            // Hide results
            document.getElementById('results-panel').style.display = 'none';
            
            updateInsight("Simulation reset. Configure your data settings and start the validation process to explore how different validation approaches reveal different truths about model performance.");
        }

        function selectStage(stageName) {
            // Just for visual feedback - actual progression is controlled by buttons
            updateInsight(getStageDescription(stageName));
        }

        function getStageDescription(stageName) {
            const descriptions = {
                internal: "Internal validation splits your existing data. Fast and cheap, but can be misleading if your data isn't representative of real-world conditions.",
                cross: "Cross-validation creates multiple train/test splits from your data. More robust than simple splitting, but still limited to your original dataset.",
                external: "External validation tests on completely independent data. The gold standard that reveals true performance, but requires significant additional investment."
            };
            return descriptions[stageName] || "Click through the validation stages to learn about each approach.";
        }

        function updateInsight(text) {
            document.getElementById('current-insight').textContent = text;
        }

        // Initialize
        updateSimulation();
    </script>
</body>
</html>